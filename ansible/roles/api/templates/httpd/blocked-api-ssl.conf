
<VirtualHost _default_:443>
    ServerAdmin {{api_host_admin}}
    DocumentRoot {{checkout_path}}/api
    ServerName {{api_host_name}}
    ErrorLog {{apache_logs}}/api.bowdlerize-secure-error_log
    CustomLog {{apache_logs}}/api.bowdlerize-secure-access_log common

    SSLEngine on
    SSLProtocol all -SSLv2

	{% if ansible_fqdn == "api.blocked.org.uk" %}
		SSLCertificateFile /etc/pki/tls/certs/blocked-2014.crt
		SSLCertificateKeyFile /etc/pki/tls/private/blocked-2014.key
		SSLCACertificateFile /etc/pki/tls/certs/blocked-ca.crt
	{% else %}

        SSLCertificateFile    {{ssl_basedir}}/certs/{{api_host_name}}.crt
        SSLCertificateKeyFile {{ssl_basedir}}/private/{{api_host_name}}.key	
	{% endif %}

    <Directory {{checkout_path}}/api>
      Options FollowSymLinks
      AllowOverride All

    </Directory>
	Alias /report {{checkout_path}}/api/1.2/report

	{% if devserver %}
	Alias /example-client {{checkout_path}}/example-client
	{% endif %}

</VirtualHost>
